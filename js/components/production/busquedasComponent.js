'use strict';var _createClass=function(){function a(c,d){for(var f,e=0;e<d.length;e++)f=d[e],f.enumerable=f.enumerable||!1,f.configurable=!0,'value'in f&&(f.writable=!0),Object.defineProperty(c,f.key,f)}return function(c,d,e){return d&&a(c.prototype,d),e&&a(c,e),c}}();function _classCallCheck(a,c){if(!(a instanceof c))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,c){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return c&&('object'==typeof c||'function'==typeof c)?c:a}function _inherits(a,c){if('function'!=typeof c&&null!==c)throw new TypeError('Super expression must either be null or a function, not '+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}var Busquedas=function(a){function c(d){_classCallCheck(this,c);var e=_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,d));return e.state={query:'',palabrasQueryArreglada:[],resultados:[],idBarriosCiudades:[],itemsPerPage:10,page:0,barriosCiudades:[],isLoading:!0},e.handlePaginacion=e.handlePaginacion.bind(e),e}return _inherits(c,a),_createClass(c,[{key:'handlePaginacion',value:function handlePaginacion(d,e){e.preventDefault(),this.setState({page:d})}},{key:'componentWillMount',value:function componentWillMount(){var e=this,d=window.location.search.substring(1).split('=')[1];d=decodeURIComponent(d),fetch('/index.php/components/busqueda/busqueda?q='+d).then(function(f){return f.json()}).then(function(f){e.setState({resultados:f.resultados,query:f.q,idBarriosCiudades:f.idBarriosCiudades,palabrasQueryArreglada:f.palabrasQueryQuisoDecir,isLoading:!1})}).catch(function(){throw alert('Lo sentimos\n\rHa habido un error al realizar la busqueda'),'Error en busqueda: '.error}),fetch('/index.php/components/busqueda/devuelveBarrios').then(function(f){return f.json()}).then(function(f){e.setState({barriosCiudades:f.barriosCiudades})})}},{key:'componentDidMount',value:function componentDidMount(){}},{key:'render',value:function render(){var n=this,m=React.Fragment,d=window.location.hostname,e=this.state.page*this.state.itemsPerPage;if(0<this.state.resultados.length)var f=this.state.resultados.slice(e,e+this.state.itemsPerPage).map(function(v){if('sin_imagen.png'==v.imagen)var w={width:'100%',height:'100%',background:'url(http://via.placeholder.com/350x350?text=sin+imagen) no-repeat center center',backgroundSize:'100%'};else var w={width:'100%',height:'100%',background:'url(http://ipa.uva.es/img_pisos/'+v.idpiso+'/'+v.imagen+') no-repeat center center',backgroundSize:'100%'};var y='http://'+d+'/index.php/pisos/producto_piso?id='+v.idpiso,z='';z=250<v.descripcion.length?v.descripcion.substr(0,250).replace('[','').replace(']','')+' ...':v.descripcion.substr(0,250).replace('[','').replace(']','');var E,A=v.extras.split('|'),B=A.map(function(F,G){switch(F){case'Cocina':return React.createElement('img',{className:'extras',src:'/img/icons/009-cocina.png',alt:'Cocina',key:G});break;case'Frigo':return React.createElement('img',{className:'extras',src:'/img/icons/004-frigorifico.png',alt:'Frigorigico',key:G});break;case'Lavadora':return React.createElement('img',{className:'extras',src:'/img/icons/010-lavadora.png',alt:'Lavadora',key:G});break;case'Vajilla':return React.createElement('img',{className:'extras',src:'/img/icons/005-vajilla.png',alt:'Vajilla',key:G});break;case'Cama':return React.createElement('img',{className:'extras',src:'/img/icons/006-cama.png',alt:'Cama',key:G});break;case'Bano':return React.createElement('img',{className:'extras',src:'/img/icons/011-servicio.png',alt:'Ba\xF1o',key:G});break;case'Horno':return React.createElement('img',{className:'extras',src:'/img/icons/008-horno.png',alt:'Horno',key:G});break;case'Secadora':return React.createElement('img',{className:'extras',src:'/img/icons/012-secadora.png',alt:'Secadora',key:G});break;case'TV':return React.createElement('img',{className:'extras',src:'/img/icons/002-television.png',alt:'TV',key:G});break;case'Telefono':return React.createElement('img',{className:'extras',src:'/img/icons/003-phone.png',alt:'Telefono',key:G});break;case'WIFI':return React.createElement('img',{className:'extras',src:'/img/icons/001-wifi.png',alt:'Internet',key:G});break;case'Compartido':return React.createElement('img',{className:'extras',src:'/img/icons/013-compartido.png',alt:'Compartido',key:G});break;default:}}),C='http://maps.google.es/maps?f=q&source=embed&hl=es&geocode=&q='+v.direccion+','+v.cp+',Espa\xF1a&vpsrc=0&ie=UTF8&hq=&hnear='+v.direccion+',Espa\xF1a&vpsrc=0&ie=UTF8&hq=&amp;hnear='+v.direccion+'&t=m&z=50&',D=n.state.barriosCiudades.filter(function(F){if(F.idbarrio==v.idbarrio&&F.idlocalizacion==v.idlocalizacion)return F});return'undefined'!==D&&0<D.length&&(E=React.createElement('span',null,D[0].barrio,' (',D[0].localizacion,')')),React.createElement('div',{className:'grid-x grid-margin-x elemento',key:v.idpiso},React.createElement('div',{className:'small-12 medium-3 cell'},React.createElement('div',{style:w},React.createElement('a',{href:'#',role:'link'},React.createElement('div',{style:{width:'100%',height:'100%'}})))),React.createElement('div',{className:'small-9 cell'},React.createElement('p',null,React.createElement('a',{href:y,role:'link'},z)),React.createElement('p',{className:'text-right extras'},B),React.createElement('p',{className:'text-right'},v.direccion.toUpperCase(),React.createElement('br',null),'barrio ',E),React.createElement('div',{className:'small-4 cell text-right'},React.createElement('p',{className:'text-right'},React.createElement('a',{href:C,className:'button small',role:'link',target:'_blank'},React.createElement('i',{className:'fi-marker'}),'\xA0\xA0Google Maps')))))});else var f=[];for(var g=Math.trunc(this.state.resultados.length/this.state.itemsPerPage),o=[],p=0;p<=g-1;p++)o.push(p);if(0==this.state.page)var h=React.createElement('li',{className:'pagination-previous disabled'},'Anterior');else var h=React.createElement('li',{className:'pagination-previous'},React.createElement('a',{href:'#','aria-label':'Anterior',onClick:this.handlePaginacion.bind(this,this.state.page-1)},'Anterior'));if(this.state.page==g-1)var j=React.createElement('li',{className:'pagination-next disabled'},'Siguiente');else var j=React.createElement('li',{className:'pagination-next'},React.createElement('a',{href:'#','aria-label':'Siguiente',onClick:this.handlePaginacion.bind(this,this.state.page+1)},'Siguiente'));var l,q=o.map(function(v,w){return React.createElement('li',{key:w,className:w==n.state.page?'active':'no_active'},React.createElement('a',{href:'#','aria-label':'Pagina '+w,onClick:n.handlePaginacion.bind(n,w)},v+1))}),k=this.state.query.split(' ');if(0<this.state.palabrasQueryArreglada.length){k=k.map(function(v){for(var x=!1,y=0;y<n.state.palabrasQueryArreglada.length;y++)if(void 0!==n.state.palabrasQueryArreglada[y][v])return x=!0,n.state.palabrasQueryArreglada[y][v];if(!0==x);else return v});var r='http://ipa.uva.es/index.php/buscar/busquedas?q='+k.join(' ');l=React.createElement('p',{className:'quizasdecir'},'Quiz\xE1s quisiste decir: ',React.createElement('strong',null,React.createElement('a',{href:r},k.join(' '))))}else var l='';if(this.state.query==k.join(' ')&&(l=''),!1===this.state.isLoading&&0<f.length){return 1<q.length?React.createElement(m,null,l,f,React.createElement('nav',{'aria-label':'Paginacion de resultados'},React.createElement('ul',{className:'pagination text-center',style:{marginTop:'1em'}},h,q,j))):React.createElement(m,null,l,f)}if(!1===this.state.isLoading&&0==f.length){var t=['https://media.giphy.com/media/OUEaBMDGNueha/200w_d.gif','https://media.giphy.com/media/qNQFUVIKAt9Ek/giphy.gif','https://media.giphy.com/media/LtyywqYw5NgNq/giphy.gif','https://media.giphy.com/media/PyRe0PRZtXGOA/giphy.gif','https://media.giphy.com/media/nlwmJQjtbfNZu/giphy-downsized.gif','https://media.giphy.com/media/slbQo8QFOUi1W/giphy-downsized.gif','https://media.giphy.com/media/IVDYYv6Cto6LS/200w_d.gif','https://media.giphy.com/media/GnqgAJvlpkK76/200w_d.gif','https://media.giphy.com/media/WClVp8rnMThvi/200w_d.gif','https://media.giphy.com/media/26BGpzKXLCgVZHdHa/giphy.gif','https://media.giphy.com/media/yNvlalDnIAATu/giphy.gif','https://media.giphy.com/media/IVDYYv6Cto6LS/giphy.gif','https://media.giphy.com/media/R2KdCa5UmhPS8/giphy.gif','https://media.giphy.com/media/oRmVa4IWfMRJm/giphy.gif','https://media.giphy.com/media/11atWmDHcwRuqA/giphy.gif','https://media.giphy.com/media/108KUzjTMEp2gw/giphy.gif','https://media.giphy.com/media/BtIpahM6na1tm/giphy.gif','https://media.giphy.com/media/UG3gvvrop9S6I/giphy.gif'],u=t[Math.floor(Math.random()*t.length+1)];return React.createElement(m,null,React.createElement('h2',{className:'borderBottom'},'Sin resultados'),React.createElement('div',{className:'grid-x grid-margin-x'},React.createElement('div',{className:'small-12 medium-4 cell'},React.createElement('p',{className:'text-center'},React.createElement('img',{src:u,width:'320'}))),React.createElement('div',{className:'small-12 medium-8 cell'},React.createElement('p',null,'Lo sentimos, ',React.createElement('strong',null,'no se han encontrado resultados de su busqueda'),'.'),l,React.createElement('p',null,'Pruebe a modificar su busqueda:'),React.createElement('ul',null,React.createElement('li',null,'Pruebe a poner palabras m\xE1s simples.'),React.createElement('li',null,'Revise que ciudad y por que barrio este buscando, quizas no exista ese barrio en esa ciudad.'),React.createElement('li',null,'Busque sinonimos de las palabras que este buscando.')))))}return React.createElement(m,null,React.createElement('p',{className:'text-center'},React.createElement('img',{src:'http://ipa.uva.es/img/loading2.gif',alt:'Cargando...',width:'150'}),'  Estamos buscando, por favor espere...'))}}]),c}(React.Component);ReactDOM.render(React.createElement(Busquedas,null),document.getElementById('busquedas')),b;
